{"ast":null,"code":"let csvToJson = require('convert-csv-to-json');\n/**\r\n * @description calculate mean\r\n * @param arr\r\n */\n\n\nconst mean = arr => {};\n/**\r\n * @description api\r\n * @param req\r\n * @param res\r\n */\n\n\nconst nb = (req, res) => {\n  let classes = new Map(); // storing classes\n\n  /* Convert csv to json */\n\n  const rawJson = csvToJson.fieldDelimiter(',').getJsonFromCsv('./shared/data/iris.csv');\n  let headers = null; // table headers, e.g. sepal_length\n\n  let test = {};\n  /* Retrieve classes */\n\n  for (let i = 0; i < rawJson.length; i++) {\n    /* We only want to store it once and not every loop, why it has ! since it's initiated as null */\n    if (!headers) {\n      headers = Object.keys(rawJson[i]);\n      headers.pop(); // remove last element, e.g. species... again, only works if it's stored last in table\n    }\n    /* Stores last object value. Will only work when class is stored last in table, thus last in object. For dynamic purpose. */\n\n\n    let tmp = rawJson[i][Object.keys(rawJson[i])[Object.keys(rawJson[i]).length - 1]]; // class name, e.g. Iris-setosa\n\n    classes.set(tmp,\n    /* Will store attributes as object properties and store it */\n\n    /* E.g. 'Iris-virginica' => { sepal_length: null, sepal_width: null, petal_length: null, petal_width: null } */\n    headers.reduce((acc, cur) => {\n      acc[cur] = null;\n      return acc;\n    }, {}));\n  }\n  /* Map -> Object ... it has the classes names */\n\n\n  let obj = Array.from(classes).reduce((obj, [key, value]) => {\n    obj[key] = value;\n    return obj;\n  }, {});\n  console.log(classes);\n  res.send(JSON.stringify(obj, null, 2));\n};\n\nexport default nb;","map":{"version":3,"sources":["C:/Users/fredr/Documents/Universitet/HT20/2DV515 - Web Intelligence/A4/pages/api/nb.ts"],"names":["csvToJson","require","mean","arr","nb","req","res","classes","Map","rawJson","fieldDelimiter","getJsonFromCsv","headers","test","i","length","Object","keys","pop","tmp","set","reduce","acc","cur","obj","Array","from","key","value","console","log","send","JSON","stringify"],"mappings":"AACA,IAAIA,SAAS,GAAGC,OAAO,CAAC,qBAAD,CAAvB;AAEA;AACA;AACA;AACA;;;AACA,MAAMC,IAAI,GAAIC,GAAD,IAAiC,CAAE,CAAhD;AAEA;AACA;AACA;AACA;AACA;;;AACA,MAAMC,EAAE,GAAG,CAACC,GAAD,EAAsBC,GAAtB,KAA+C;AACxD,MAAIC,OAAO,GAAG,IAAIC,GAAJ,EAAd,CADwD,CAChC;;AAExB;;AACA,QAAMC,OAAO,GAAGT,SAAS,CACtBU,cADa,CACE,GADF,EAEbC,cAFa,CAEE,wBAFF,CAAhB;AAIA,MAAIC,OAAsB,GAAG,IAA7B,CARwD,CAQtB;;AAClC,MAAIC,IAAI,GAAG,EAAX;AAEA;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,OAAO,CAACM,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACvC;AACA,QAAI,CAACF,OAAL,EAAc;AACZA,MAAAA,OAAO,GAAGI,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACK,CAAD,CAAnB,CAAV;AACAF,MAAAA,OAAO,CAACM,GAAR,GAFY,CAEE;AACf;AAED;;;AACA,QAAIC,GAAG,GACLV,OAAO,CAACK,CAAD,CAAP,CAAWE,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACK,CAAD,CAAnB,EAAwBE,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACK,CAAD,CAAnB,EAAwBC,MAAxB,GAAiC,CAAzD,CAAX,CADF,CARuC,CASmC;;AAE1ER,IAAAA,OAAO,CAACa,GAAR,CACED,GADF;AAEE;;AACA;AACAP,IAAAA,OAAO,CAACS,MAAR,CAAe,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC3BD,MAAAA,GAAG,CAACC,GAAD,CAAH,GAAW,IAAX;AACA,aAAOD,GAAP;AACD,KAHD,EAGG,EAHH,CAJF;AASD;AAED;;;AACA,MAAIE,GAAG,GAAGC,KAAK,CAACC,IAAN,CAAWnB,OAAX,EAAoBc,MAApB,CAA2B,CAACG,GAAD,EAAM,CAACG,GAAD,EAAMC,KAAN,CAAN,KAAuB;AAC1DJ,IAAAA,GAAG,CAACG,GAAD,CAAH,GAAWC,KAAX;AACA,WAAOJ,GAAP;AACD,GAHS,EAGP,EAHO,CAAV;AAKAK,EAAAA,OAAO,CAACC,GAAR,CAAYvB,OAAZ;AAEAD,EAAAA,GAAG,CAACyB,IAAJ,CAASC,IAAI,CAACC,SAAL,CAAeT,GAAf,EAAoB,IAApB,EAA0B,CAA1B,CAAT;AACD,CA3CD;;AA6CA,eAAepB,EAAf","sourcesContent":["import { NextApiRequest, NextApiResponse } from 'next'\r\nlet csvToJson = require('convert-csv-to-json')\r\n\r\n/**\r\n * @description calculate mean\r\n * @param arr\r\n */\r\nconst mean = (arr: Array<number | string>) => {}\r\n\r\n/**\r\n * @description api\r\n * @param req\r\n * @param res\r\n */\r\nconst nb = (req: NextApiRequest, res: NextApiResponse) => {\r\n  let classes = new Map() // storing classes\r\n\r\n  /* Convert csv to json */\r\n  const rawJson = csvToJson\r\n    .fieldDelimiter(',')\r\n    .getJsonFromCsv('./shared/data/iris.csv')\r\n\r\n  let headers: Array<string> = null // table headers, e.g. sepal_length\r\n  let test = {}\r\n\r\n  /* Retrieve classes */\r\n  for (let i = 0; i < rawJson.length; i++) {\r\n    /* We only want to store it once and not every loop, why it has ! since it's initiated as null */\r\n    if (!headers) {\r\n      headers = Object.keys(rawJson[i])\r\n      headers.pop() // remove last element, e.g. species... again, only works if it's stored last in table\r\n    }\r\n\r\n    /* Stores last object value. Will only work when class is stored last in table, thus last in object. For dynamic purpose. */\r\n    let tmp =\r\n      rawJson[i][Object.keys(rawJson[i])[Object.keys(rawJson[i]).length - 1]] // class name, e.g. Iris-setosa\r\n\r\n    classes.set(\r\n      tmp,\r\n      /* Will store attributes as object properties and store it */\r\n      /* E.g. 'Iris-virginica' => { sepal_length: null, sepal_width: null, petal_length: null, petal_width: null } */\r\n      headers.reduce((acc, cur) => {\r\n        acc[cur] = null\r\n        return acc\r\n      }, {})\r\n    )\r\n  }\r\n\r\n  /* Map -> Object ... it has the classes names */\r\n  let obj = Array.from(classes).reduce((obj, [key, value]) => {\r\n    obj[key] = value\r\n    return obj\r\n  }, {})\r\n\r\n  console.log(classes)\r\n\r\n  res.send(JSON.stringify(obj, null, 2))\r\n}\r\n\r\nexport default nb\r\n"]},"metadata":{},"sourceType":"module"}